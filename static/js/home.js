// Generated by CoffeeScript 1.4.0
(function() {

  $(function() {
    var App, DayView, HomeModel, HomeView, InputView, PlanView, PlannerView, TaskView, WeekView, json_data, weekdays;
    json_data = {};
    $.ajax({
      url: '/home_data',
      async: false,
      success: function(data) {
        return json_data = data;
      }
    });
    weekdays = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
    HomeModel = Backbone.Model.extend({
      initialize: function() {
        return console.log("dashboard model initialized");
      }
    });
    HomeView = Backbone.View.extend({
      el: '#home',
      initialize: function() {
        this.model = new HomeModel();
        this.input = new InputView({
          model: this.model
        });
        this.thisWeek = new WeekView({
          which: 'this',
          model: this.model
        });
        this.nextWeek = new WeekView({
          which: 'next',
          model: this.model
        });
        return this.planner = new PlannerView({
          model: this.model
        });
      }
    });
    WeekView = Backbone.View.extend({
      initialize: function() {
        var day, i, _results, _results1;
        if (this.options.which === 'this') {
          this.el = '#this_week';
          this.days = [];
          i = 0;
          _results = [];
          while (i < 7) {
            day = new DayView({
              which: i,
              model: this.model
            });
            this.days.push(day);
            _results.push(i += 1);
          }
          return _results;
        } else if (this.options.which === 'next') {
          this.el = '#next_week';
          this.days = [];
          i = 7;
          _results1 = [];
          while (i < 14) {
            day = new DayView({
              which: i,
              model: this.model
            });
            this.days.push(day);
            _results1.push(i += 1);
          }
          return _results1;
        } else {
          return console.log('You done goofed, son.');
        }
      },
      render: function() {}
    });
    PlannerView = Backbone.View.extend({
      initialize: function() {},
      render: function() {}
    });
    DayView = Backbone.View.extend({
      template: _.template($('#day_template').html()),
      initialize: function() {
        var f_or_s, i, task, task_detail, weekday, _i, _len, _ref, _results;
        i = this.options.which;
        this.template({
          day: json_data.two_weeks[i]
        });
        this.tasks = [];
        weekday = weekdays[i % 7];
        if (i < 7) {
          f_or_s = "First";
        } else {
          f_or_s = "Second";
        }
        _ref = json_data.tasks[f_or_s][weekday];
        _results = [];
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          task_detail = _ref[_i];
          task = new TaskView({
            model: this.model,
            detail: task_detail
          });
          _results.push(this.tasks.push(task));
        }
        return _results;
      },
      render: function() {}
    });
    TaskView = Backbone.View.extend({
      template: _.template($("#task_template").html()),
      initialize: function() {}
    });
    PlanView = Backbone.View.extend({
      initialize: function() {},
      toggleDone: function() {},
      move: function() {}
    });
    InputView = Backbone.View.extend({
      el: $('#input_container'),
      template: _.template($('#inputter_template').html()),
      initialize: function() {
        var now, nowTemp;
        this.render();
        nowTemp = new Date();
        now = new Date(nowTemp.getFullYear(), nowTemp.getMonth(), nowTemp.getDate(), 0, 0, 0, 0);
        return $('#dawg').datepicker({
          onRender: function(date) {
            if (date.valueOf() < now.valueOf()) {
              return "disabled";
            } else {
              return "";
            }
          }
        });
      },
      render: function() {
        $(this.el).html(this.template({
          today: json_data.today
        }));
        return this;
      },
      new_task: function() {
        var data;
        data = {
          name: this.task_name,
          date: this.task_date,
          length: this.task_length
        };
        return $.post("/addtask", data, function(d, st, xr) {
          return "Done";
        });
      }
    });
    return App = new HomeView();
  });

}).call(this);
